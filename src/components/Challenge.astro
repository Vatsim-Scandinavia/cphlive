---
// Challenge component
interface Props {
    title: string;
    description: string;
    backgroundImage?: string;
    requirements: Array<{
        type: 'departure' | 'arrival' | 'time' | 'flightRules' | 'airport' | 'bookingRequired';
        count?: number;
        value?: string;
        tooltip?: string;
    }>;
    sponsors: Array<{
        name: string;
        logo: string;
    }>;
    prize: Array<{
            count: number;
            text: string;
    }>;
}

const { title, description, requirements, prize, backgroundImage, sponsors } = Astro.props;

// SVG paths for different requirement types
const svgPaths = {
    arrival: "M248,216a8.00008,8.00008,0,0,1-8,8H96a8,8,0,0,1,0-16H240A8.00008,8.00008,0,0,1,248,216Zm-24-28a4.00035,4.00035,0,0,0,4-4V148.32275a36.10691,36.10691,0,0,0-26.36523-34.68652l-46.97852-13.0498L123.47266,46.01562a4.00193,4.00193,0,0,0-2.208-1.81054l-13.46973-4.49024A12.00071,12.00071,0,0,0,92,51.09961V82.55908L66.75781,74.6709,51.5293,46.11768a4.00065,4.00065,0,0,0-2.26465-1.9126L35.79492,39.71484A12.00071,12.00071,0,0,0,20,51.09961v52.62988A36.11994,36.11994,0,0,0,46.294,138.396l176.62793,49.45605A4.00591,4.00591,0,0,0,224,188Z",
    departure: "M176,216a8.00008,8.00008,0,0,1-8,8H24a8,8,0,0,1,0-16H168A8.00008,8.00008,0,0,1,176,216ZM247.0957,89.4668,228.45605,66.686a35.81374,35.81374,0,0,0-46.11523-8.2334L139.53906,83.62988,81.26465,64.20508a4.0083,4.0083,0,0,0-2.83985.11816l-16.5,7.0708A12.00078,12.00078,0,0,0,58.625,91.34375L85.21191,115.272l-21.46679,12.2666L37.5752,116.32324a4.00251,4.00251,0,0,0-3.1504,0l-16.75292,7.17969a12.00032,12.00032,0,0,0-3.48145,19.78418h.001l37.69531,35.33935a35.78229,35.78229,0,0,0,42.7168,4.85938L246.01074,95.458a4.001,4.001,0,0,0,1.085-5.99121Z"
};
---

<div class="w-72 min-h-[40rem] bg-slate-800 rounded relative">
    <div class="w-full h-10 bg-slate-900 flex items-center justify-center">
        <h1 class="text-lg font-semibold">{title}</h1>
    </div>
    <img src={backgroundImage} alt="" class="w-full">
    <p class="px-4 pt-2">
        <b class="text-center">{description.split('!')[0]}!</b><br /> 
    </p>
    <p class="px-4 text-sm">
        {description.split('!').slice(1).join('!')}
    </p>

    <span class="absolute bottom-0 left-0 right-0">
        <hr class="border-slate-600 mx-4 my-2" />
        <div class="px-4 text-center">
            <img src={sponsors[0].logo} alt={sponsors[0].name} class="h-6 my-1 mx-auto" />
            {prize.map((p) => (
                <div>
                    <b>{p.count} x {p.text}</b>
                </div>
            ))}
        </div>
        <hr class="border-slate-600 mx-4 my-2" />
        <div class="gap-2 grid grid-cols-3 grid-rows-2 mx-4">
            {requirements.map((req) => (
                <span class="bg-slate-900 aspect-square w-full font-bold flex justify-center items-center flex-col rounded" title={req.tooltip ?? ""}>
                    {req.type === 'departure' || req.type === 'arrival' ? (
                        <svg viewBox="0 0 256 256" class="w-3/7" fill="white">
                            <path d={svgPaths[req.type]} />
                        </svg>
                    ) : req.type === 'flightRules' ? (
                        <img src="/icons/book-open-svgrepo-com.svg" alt="" class="w-3/7" />
                    ) : req.type === 'time' ? (
                        <img src="/icons/clock-two-svgrepo-com.svg" alt="" class="w-3/7" />
                    ) : req.type === 'airport' ? (
                        <img src="/icons/airport-svgrepo-com.svg" alt="" class="w-3/7" />
                    ) : req.type === 'bookingRequired' ? (
                        <img src="/icons/ticket-svgrepo-com.svg" alt="" class="w-3/7" />
                    ) : null}
                    <p >{req.count ?? req.value}</p>
                </span>
            ))}
        </div>
        <hr class="border-slate-600 mx-4 my-2" />
        <div class="mx-4 mb-2">
            <a href="https://booking.vatsim-scandinavia.org/" target="_blank" rel="noopener noreferrer">
                <button class="w-full py-2 bg-slate-900 hover:bg-slate-600 rounded ">
                    Participate
                </button>
            </a>
        </div>
    </span>

</div>
